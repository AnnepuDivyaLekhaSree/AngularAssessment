
<table  mat-table [dataSource]="dataSource">
  <ng-container matColumnDef="id">
    <th mat-header-cell *matHeaderCellDef>ID</th>
  </ng-container>
  <ng-container matColumnDef="firstName">
    <th mat-header-cell *matHeaderCellDef>firstName</th>
  </ng-container>
  <ng-container matColumnDef="lastName">
    <th mat-header-cell *matHeaderCellDef>lastName</th>
  </ng-container>
  <ng-container matColumnDef="age">
    <th mat-header-cell *matHeaderCellDef>Age</th>
  </ng-container>
  <ng-container matColumnDef="gender">
    <th mat-header-cell *matHeaderCellDef>gender</th>
  </ng-container>
  <ng-container matColumnDef="expanded">
    <td mat-cell *matCellDef="let item; let i=index" [attr.colspan]="displayedColumns.length" style="padding: 0px;">
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <div style="display: flex; flex-grow: 1; justify-content: space-between;">
            <div>{{ item.id }}</div>
            <div>{{ item.firstName }}</div>
            <div>{{ item.lastName }}</div>
            <div>{{ item.age }}</div>
            <div>{{ item.gender }}</div>
          </div>
        </mat-expansion-panel-header>
        <mat-form-field>
          <mat-label>firstName</mat-label>
          <input matInput [(ngModel)]="userList[i].firstName" [ngModelOptions]="{standalone: true}" (ngModelChange)="onValueChange(item.id,'firstname', $event)"  placeholder="First Name">
        </mat-form-field>
        <mat-form-field>
          <mat-label>lastName</mat-label>
          <input matInput  [(ngModel)]="userList[i].lastName" [ngModelOptions]="{standalone: true}" (ngModelChange)="onValueChange(item.id,'lastname', $event)" >
        </mat-form-field>
        <mat-form-field>
          <mat-label>Age</mat-label>
          <input matInput type="number"  [(ngModel)]="userList[i].age" [ngModelOptions]="{standalone: true}" (ngModelChange)="onValueChange(item.id,'age',$event)">
        </mat-form-field>
        <mat-form-field>
          <mat-label>Gender</mat-label>
          <input matInput [(ngModel)]="userList[i].gender" [ngModelOptions]="{standalone: true}" (ngModelChange)="onValueChange(item.id,'gender',$event)"  >
        </mat-form-field>
        <mat-action-row>
          <button type="button" (click)="onUpdateUser(item, $event)" [disabled]="saving">
            <span *ngIf="!saving">Save</span>
            <span *ngIf="saving" class="spinner-overlay">
              <mat-spinner diameter="20">Save</mat-spinner>
            </span>
          </button>
          <button mat-button color="danger" (click)="Cancel(item, $event)" [disabled]="saving">Cancel</button>
         
        </mat-action-row>
      </mat-expansion-panel>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <!-- <tr mat-row *matRowDef="let item; columns: displayedColumns;"></tr> -->
  <tr mat-row *matRowDef="let item; columns: ['expanded']" class="expanded-row"></tr>
</table>


